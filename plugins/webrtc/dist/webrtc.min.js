!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("leancloud-realtime")):"function"==typeof define&&define.amd?define("webrtc",["exports","leancloud-realtime"],b):b(a.AV=a.AV||{},a.AV)}(this,function(a,b){"use strict";function c(a){return a&&a.__esModule?a.default:a}function d(a,b){return b={exports:{}},a(b,b.exports),b.exports}function e(a){var b,c;this.promise=new a(function(a,d){if(void 0!==b||void 0!==c)throw TypeError("Bad Promise constructor");b=a,c=d}),this.resolve=p(b),this.reject=p(c)}var f="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},g=function(a,b){return{value:b,done:!!a}},h={},i={}.toString,j=function(a){return i.call(a).slice(8,-1)},k=Object("z").propertyIsEnumerable(0)?Object:function(a){return"String"==j(a)?a.split(""):Object(a)},l=function(a){if(void 0==a)throw TypeError("Can't call method on  "+a);return a},m=function(a){return k(l(a))},n=d(function(a){var b=a.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=b)}),o=d(function(a){var b=a.exports={version:"2.5.0"};"number"==typeof __e&&(__e=b)}),p=function(a){if("function"!=typeof a)throw TypeError(a+" is not a function!");return a},q=function(a,b,c){if(p(a),void 0===b)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)}}return function(){return a.apply(b,arguments)}},r=function(a){return"object"==typeof a?null!==a:"function"==typeof a},s=function(a){if(!r(a))throw TypeError(a+" is not an object!");return a},t=function(a){try{return!!a()}catch(a){return!0}},u=!t(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),v=n.document,w=r(v)&&r(v.createElement),x=function(a){return w?v.createElement(a):{}},y=!u&&!t(function(){return 7!=Object.defineProperty(x("div"),"a",{get:function(){return 7}}).a}),z=function(a,b){if(!r(a))return a;var c,d;if(b&&"function"==typeof(c=a.toString)&&!r(d=c.call(a)))return d;if("function"==typeof(c=a.valueOf)&&!r(d=c.call(a)))return d;if(!b&&"function"==typeof(c=a.toString)&&!r(d=c.call(a)))return d;throw TypeError("Can't convert object to primitive value")},A=Object.defineProperty,B=u?Object.defineProperty:function(a,b,c){if(s(a),b=z(b,!0),s(c),y)try{return A(a,b,c)}catch(a){}if("get"in c||"set"in c)throw TypeError("Accessors not supported!");return"value"in c&&(a[b]=c.value),a},C={f:B},D=function(a,b){return{enumerable:!(1&a),configurable:!(2&a),writable:!(4&a),value:b}},E=u?function(a,b,c){return C.f(a,b,D(1,c))}:function(a,b,c){return a[b]=c,a},F=function(a,b,c){var d,e,f,g=a&F.F,h=a&F.G,i=a&F.S,j=a&F.P,k=a&F.B,l=a&F.W,m=h?o:o[b]||(o[b]={}),p=m.prototype,r=h?n:i?n[b]:(n[b]||{}).prototype;h&&(c=b);for(d in c)(e=!g&&r&&void 0!==r[d])&&d in m||(f=e?r[d]:c[d],m[d]=h&&"function"!=typeof r[d]?c[d]:k&&e?q(f,n):l&&r[d]==f?function(a){var b=function(b,c,d){if(this instanceof a){switch(arguments.length){case 0:return new a;case 1:return new a(b);case 2:return new a(b,c)}return new a(b,c,d)}return a.apply(this,arguments)};return b.prototype=a.prototype,b}(f):j&&"function"==typeof f?q(Function.call,f):f,j&&((m.virtual||(m.virtual={}))[d]=f,a&F.R&&p&&!p[d]&&E(p,d,f)))};F.F=1,F.G=2,F.S=4,F.P=8,F.B=16,F.W=32,F.U=64,F.R=128;var G=F,H=E,I={}.hasOwnProperty,J=function(a,b){return I.call(a,b)},K=Math.ceil,L=Math.floor,M=function(a){return isNaN(a=+a)?0:(a>0?L:K)(a)},N=Math.min,O=function(a){return a>0?N(M(a),9007199254740991):0},P=Math.max,Q=Math.min,R=function(a,b){return a=M(a),a<0?P(a+b,0):Q(a,b)},S=n["__core-js_shared__"]||(n["__core-js_shared__"]={}),T=function(a){return S[a]||(S[a]={})},U=0,V=Math.random(),W=function(a){return"Symbol(".concat(void 0===a?"":a,")_",(++U+V).toString(36))},X=T("keys"),Y=function(a){return X[a]||(X[a]=W(a))},Z=function(a){return function(b,c,d){var e,f=m(b),g=O(f.length),h=R(d,g);if(a&&c!=c){for(;g>h;)if((e=f[h++])!=e)return!0}else for(;g>h;h++)if((a||h in f)&&f[h]===c)return a||h||0;return!a&&-1}}(!1),$=Y("IE_PROTO"),_=function(a,b){var c,d=m(a),e=0,f=[];for(c in d)c!=$&&J(d,c)&&f.push(c);for(;b.length>e;)J(d,c=b[e++])&&(~Z(f,c)||f.push(c));return f},aa="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),ba=Object.keys||function(a){return _(a,aa)},ca=u?Object.defineProperties:function(a,b){s(a);for(var c,d=ba(b),e=d.length,f=0;e>f;)C.f(a,c=d[f++],b[c]);return a},da=n.document,ea=da&&da.documentElement,fa=Y("IE_PROTO"),ga=function(){},ha=function(){var a,b=x("iframe"),c=aa.length;for(b.style.display="none",ea.appendChild(b),b.src="javascript:",a=b.contentWindow.document,a.open(),a.write("<script>document.F=Object<\/script>"),a.close(),ha=a.F;c--;)delete ha.prototype[aa[c]];return ha()},ia=Object.create||function(a,b){var c;return null!==a?(ga.prototype=s(a),c=new ga,ga.prototype=null,c[fa]=a):c=ha(),void 0===b?c:ca(c,b)},ja=d(function(a){var b=T("wks"),c=n.Symbol,d="function"==typeof c;(a.exports=function(a){return b[a]||(b[a]=d&&c[a]||(d?c:W)("Symbol."+a))}).store=b}),ka=C.f,la=ja("toStringTag"),ma=function(a,b,c){a&&!J(a=c?a:a.prototype,la)&&ka(a,la,{configurable:!0,value:b})},na={};E(na,ja("iterator"),function(){return this});var oa=function(a,b,c){a.prototype=ia(na,{next:D(1,c)}),ma(a,b+" Iterator")},pa=function(a){return Object(l(a))},qa=Y("IE_PROTO"),ra=Object.prototype,sa=Object.getPrototypeOf||function(a){return a=pa(a),J(a,qa)?a[qa]:"function"==typeof a.constructor&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?ra:null},ta=ja("iterator"),ua=!([].keys&&"next"in[].keys()),va=function(){return this},wa=function(a,b,c,d,e,f,g){oa(c,b,d);var i,j,k,l=function(a){if(!ua&&a in p)return p[a];switch(a){case"keys":case"values":return function(){return new c(this,a)}}return function(){return new c(this,a)}},m=b+" Iterator",n="values"==e,o=!1,p=a.prototype,q=p[ta]||p["@@iterator"]||e&&p[e],r=q||l(e),s=e?n?l("entries"):r:void 0,t="Array"==b?p.entries||q:q;if(t&&(k=sa(t.call(new a)))!==Object.prototype&&k.next&&ma(k,m,!0),n&&q&&"values"!==q.name&&(o=!0,r=function(){return q.call(this)}),g&&(ua||o||!p[ta])&&E(p,ta,r),h[b]=r,h[m]=va,e)if(i={values:n?r:l("values"),keys:f?r:l("keys"),entries:s},g)for(j in i)j in p||H(p,j,i[j]);else G(G.P+G.F*(ua||o),b,i);return i};wa(Array,"Array",function(a,b){this._t=m(a),this._i=0,this._k=b},function(){var a=this._t,b=this._k,c=this._i++;return!a||c>=a.length?(this._t=void 0,g(1)):"keys"==b?g(0,c):"values"==b?g(0,a[c]):g(0,[c,a[c]])},"values");h.Arguments=h.Array;for(var xa=ja("toStringTag"),ya="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),za=0;za<ya.length;za++){var Aa=ya[za],Ba=n[Aa],Ca=Ba&&Ba.prototype;Ca&&!Ca[xa]&&E(Ca,xa,Aa),h[Aa]=h.Array}var Da=function(a){return function(b,c){var d,e,f=String(l(b)),g=M(c),h=f.length;return g<0||g>=h?a?"":void 0:(d=f.charCodeAt(g),d<55296||d>56319||g+1===h||(e=f.charCodeAt(g+1))<56320||e>57343?a?f.charAt(g):d:a?f.slice(g,g+2):e-56320+(d-55296<<10)+65536)}}(!0);wa(String,"String",function(a){this._t=String(a),this._i=0},function(){var a,b=this._t,c=this._i;return c>=b.length?{value:void 0,done:!0}:(a=Da(b,c),this._i+=a.length,{value:a,done:!1})});var Ea,Fa,Ga,Ha=ja("toStringTag"),Ia="Arguments"==j(function(){return arguments}()),Ja=function(a,b){try{return a[b]}catch(a){}},Ka=function(a){var b,c,d;return void 0===a?"Undefined":null===a?"Null":"string"==typeof(c=Ja(b=Object(a),Ha))?c:Ia?j(b):"Object"==(d=j(b))&&"function"==typeof b.callee?"Arguments":d},La=ja("iterator"),Ma=o.isIterable=function(a){var b=Object(a);return void 0!==b[La]||"@@iterator"in b||h.hasOwnProperty(Ka(b))},Na=Ma,Oa=d(function(a){a.exports={default:Na,__esModule:!0}}),Pa=ja("iterator"),Qa=o.getIteratorMethod=function(a){if(void 0!=a)return a[Pa]||a["@@iterator"]||h[Ka(a)]},Ra=o.getIterator=function(a){var b=Qa(a);if("function"!=typeof b)throw TypeError(a+" is not iterable!");return s(b.call(a))},Sa=Ra,Ta=d(function(a){a.exports={default:Sa,__esModule:!0}}),Ua=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(Oa),e=c(Ta);b.default=function(){function a(a,b){var c=[],d=!0,f=!1,g=void 0;try{for(var h,i=(0,e.default)(a);!(d=(h=i.next()).done)&&(c.push(h.value),!b||c.length!==b);d=!0);}catch(a){f=!0,g=a}finally{try{!d&&i.return&&i.return()}finally{if(f)throw g}}return c}return function(b,c){if(Array.isArray(b))return b;if((0,d.default)(Object(b)))return a(b,c);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),Va=c(Ua),Wa=function(a,b,c,d){if(!(a instanceof b)||void 0!==d&&d in a)throw TypeError(c+": incorrect invocation!");return a},Xa=function(a,b,c,d){try{return d?b(s(c)[0],c[1]):b(c)}catch(b){var e=a.return;throw void 0!==e&&s(e.call(a)),b}},Ya=ja("iterator"),Za=Array.prototype,$a=function(a){return void 0!==a&&(h.Array===a||Za[Ya]===a)},_a=d(function(a){var b={},c={},d=a.exports=function(a,d,e,f,g){var h,i,j,k,l=g?function(){return a}:Qa(a),m=q(e,f,d?2:1),n=0;if("function"!=typeof l)throw TypeError(a+" is not iterable!");if($a(l)){for(h=O(a.length);h>n;n++)if((k=d?m(s(i=a[n])[0],i[1]):m(a[n]))===b||k===c)return k}else for(j=l.call(a);!(i=j.next()).done;)if((k=Xa(j,m,i.value,d))===b||k===c)return k};d.BREAK=b,d.RETURN=c}),ab=ja("species"),bb=function(a,b){var c,d=s(a).constructor;return void 0===d||void 0==(c=s(d)[ab])?b:p(c)},cb=function(a,b,c){var d=void 0===c;switch(b.length){case 0:return d?a():a.call(c);case 1:return d?a(b[0]):a.call(c,b[0]);case 2:return d?a(b[0],b[1]):a.call(c,b[0],b[1]);case 3:return d?a(b[0],b[1],b[2]):a.call(c,b[0],b[1],b[2]);case 4:return d?a(b[0],b[1],b[2],b[3]):a.call(c,b[0],b[1],b[2],b[3])}return a.apply(c,b)},db=n.process,eb=n.setImmediate,fb=n.clearImmediate,gb=n.MessageChannel,hb=n.Dispatch,ib=0,jb={},kb=function(){var a=+this;if(jb.hasOwnProperty(a)){var b=jb[a];delete jb[a],b()}},lb=function(a){kb.call(a.data)};eb&&fb||(eb=function(a){for(var b=[],c=1;arguments.length>c;)b.push(arguments[c++]);return jb[++ib]=function(){cb("function"==typeof a?a:Function(a),b)},Ea(ib),ib},fb=function(a){delete jb[a]},"process"==j(db)?Ea=function(a){db.nextTick(q(kb,a,1))}:hb&&hb.now?Ea=function(a){hb.now(q(kb,a,1))}:gb?(Fa=new gb,Ga=Fa.port2,Fa.port1.onmessage=lb,Ea=q(Ga.postMessage,Ga,1)):n.addEventListener&&"function"==typeof postMessage&&!n.importScripts?(Ea=function(a){n.postMessage(a+"","*")},n.addEventListener("message",lb,!1)):Ea="onreadystatechange"in x("script")?function(a){ea.appendChild(x("script")).onreadystatechange=function(){ea.removeChild(this),kb.call(a)}}:function(a){setTimeout(q(kb,a,1),0)});var mb={set:eb,clear:fb},nb=mb.set,ob=n.MutationObserver||n.WebKitMutationObserver,pb=n.process,qb=n.Promise,rb="process"==j(pb),sb=function(a){return new e(a)},tb={f:sb},ub=function(a){try{return{e:!1,v:a()}}catch(a){return{e:!0,v:a}}},vb=function(a,b){var c=tb.f(a);return(0,c.resolve)(b),c.promise},wb=ja("species"),xb=ja("iterator"),yb=!1;try{var zb=[7][xb]();zb.return=function(){yb=!0},Array.from(zb,function(){throw 2})}catch(a){}var Ab,Bb,Cb,Db,Eb=mb.set,Fb=function(){var a,b,c,d=function(){var d,e;for(rb&&(d=pb.domain)&&d.exit();a;){e=a.fn,a=a.next;try{e()}catch(d){throw a?c():b=void 0,d}}b=void 0,d&&d.enter()};if(rb)c=function(){pb.nextTick(d)};else if(ob){var e=!0,f=document.createTextNode("");new ob(d).observe(f,{characterData:!0}),c=function(){f.data=e=!e}}else if(qb&&qb.resolve){var g=qb.resolve();c=function(){g.then(d)}}else c=function(){nb.call(n,d)};return function(d){var e={fn:d,next:void 0};b&&(b.next=e),a||(a=e,c()),b=e}}(),Gb=n.TypeError,Hb=n.process,Ib=n.Promise,Jb="process"==Ka(Hb),Kb=function(){},Lb=Bb=tb.f,Mb=!!function(){try{var a=Ib.resolve(1),b=(a.constructor={})[ja("species")]=function(a){a(Kb,Kb)};return(Jb||"function"==typeof PromiseRejectionEvent)&&a.then(Kb)instanceof b}catch(a){}}(),Nb=function(a,b){return a===b||a===Ib&&b===Db},Ob=function(a){var b;return!(!r(a)||"function"!=typeof(b=a.then))&&b},Pb=function(a,b){if(!a._n){a._n=!0;var c=a._c;Fb(function(){for(var d=a._v,e=1==a._s,f=0;c.length>f;)!function(b){var c,f,g=e?b.ok:b.fail,h=b.resolve,i=b.reject,j=b.domain;try{g?(e||(2==a._h&&Sb(a),a._h=1),!0===g?c=d:(j&&j.enter(),c=g(d),j&&j.exit()),c===b.promise?i(Gb("Promise-chain cycle")):(f=Ob(c))?f.call(c,h,i):h(c)):i(d)}catch(a){i(a)}}(c[f++]);a._c=[],a._n=!1,b&&!a._h&&Qb(a)})}},Qb=function(a){Eb.call(n,function(){var b,c,d,e=a._v,f=Rb(a);if(f&&(b=ub(function(){Jb?Hb.emit("unhandledRejection",e,a):(c=n.onunhandledrejection)?c({promise:a,reason:e}):(d=n.console)&&d.error&&d.error("Unhandled promise rejection",e)}),a._h=Jb||Rb(a)?2:1),a._a=void 0,f&&b.e)throw b.v})},Rb=function(a){if(1==a._h)return!1;for(var b,c=a._a||a._c,d=0;c.length>d;)if(b=c[d++],b.fail||!Rb(b.promise))return!1;return!0},Sb=function(a){Eb.call(n,function(){var b;Jb?Hb.emit("rejectionHandled",a):(b=n.onrejectionhandled)&&b({promise:a,reason:a._v})})},Tb=function(a){var b=this;b._d||(b._d=!0,b=b._w||b,b._v=a,b._s=2,b._a||(b._a=b._c.slice()),Pb(b,!0))},Ub=function(a){var b,c=this;if(!c._d){c._d=!0,c=c._w||c;try{if(c===a)throw Gb("Promise can't be resolved itself");(b=Ob(a))?Fb(function(){var d={_w:c,_d:!1};try{b.call(a,q(Ub,d,1),q(Tb,d,1))}catch(a){Tb.call(d,a)}}):(c._v=a,c._s=1,Pb(c,!1))}catch(a){Tb.call({_w:c,_d:!1},a)}}};Mb||(Ib=function(a){Wa(this,Ib,"Promise","_h"),p(a),Ab.call(this);try{a(q(Ub,this,1),q(Tb,this,1))}catch(a){Tb.call(this,a)}},Ab=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},Ab.prototype=function(a,b,c){for(var d in b)c&&a[d]?a[d]=b[d]:E(a,d,b[d]);return a}(Ib.prototype,{then:function(a,b){var c=Lb(bb(this,Ib));return c.ok="function"!=typeof a||a,c.fail="function"==typeof b&&b,c.domain=Jb?Hb.domain:void 0,this._c.push(c),this._a&&this._a.push(c),this._s&&Pb(this,!1),c.promise},catch:function(a){return this.then(void 0,a)}}),Cb=function(){var a=new Ab;this.promise=a,this.resolve=q(Ub,a,1),this.reject=q(Tb,a,1)},tb.f=Lb=function(a){return Nb(Ib,a)?new Cb(a):Bb(a)}),G(G.G+G.W+G.F*!Mb,{Promise:Ib}),ma(Ib,"Promise"),function(a){var b="function"==typeof o[a]?o[a]:n[a];u&&b&&!b[wb]&&C.f(b,wb,{configurable:!0,get:function(){return this}})}("Promise"),Db=o.Promise,G(G.S+G.F*!Mb,"Promise",{reject:function(a){var b=Lb(this);return(0,b.reject)(a),b.promise}}),G(G.S+!0*G.F,"Promise",{resolve:function(a){return a instanceof Ib&&Nb(a.constructor,this)?a:vb(this,a)}}),G(G.S+G.F*!(Mb&&function(a,b){if(!b&&!yb)return!1;var c=!1;try{var d=[7],e=d[xb]();e.next=function(){return{done:c=!0}},d[xb]=function(){return e},a(d)}catch(a){}return c}(function(a){Ib.all(a).catch(Kb)})),"Promise",{all:function(a){var b=this,c=Lb(b),d=c.resolve,e=c.reject,f=ub(function(){var c=[],f=0,g=1;_a(a,!1,function(a){var h=f++,i=!1;c.push(void 0),g++,b.resolve(a).then(function(a){i||(i=!0,c[h]=a,--g||d(c))},e)}),--g||d(c)});return f.e&&e(f.v),c.promise},race:function(a){var b=this,c=Lb(b),d=c.reject,e=ub(function(){_a(a,!1,function(a){b.resolve(a).then(c.resolve,d)})});return e.e&&d(e.v),c.promise}}),G(G.P+G.R,"Promise",{finally:function(a){var b=bb(this,o.Promise||n.Promise),c="function"==typeof a;return this.then(c?function(c){return vb(b,a()).then(function(){return c})}:a,c?function(c){return vb(b,a()).then(function(){throw c})}:a)}}),G(G.S,"Promise",{try:function(a){var b=tb.f(this),c=ub(a);return(c.e?b.reject:b.resolve)(c.v),b.promise}});var Vb=o.Promise,Wb=d(function(a){a.exports={default:Vb,__esModule:!0}}),Xb=c(Wb),Yb=Object.getOwnPropertySymbols,Zb={f:Yb},$b={}.propertyIsEnumerable,_b={f:$b},ac=Object.assign,bc=!ac||t(function(){var a={},b={},c=Symbol(),d="abcdefghijklmnopqrst";return a[c]=7,d.split("").forEach(function(a){b[a]=a}),7!=ac({},a)[c]||Object.keys(ac({},b)).join("")!=d})?function(a,b){for(var c=pa(a),d=arguments.length,e=1,f=Zb.f,g=_b.f;d>e;)for(var h,i=k(arguments[e++]),j=f?ba(i).concat(f(i)):ba(i),l=j.length,m=0;l>m;)g.call(i,h=j[m++])&&(c[h]=i[h]);return c}:ac;G(G.S+G.F,"Object",{assign:bc});var cc=o.Object.assign,dc=d(function(a){a.exports={default:cc,__esModule:!0}}),ec=c(dc),fc=d(function(a,b){b.__esModule=!0,b.default=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}}),gc=c(fc),hc=ja,ic={f:hc},jc=ic.f("iterator"),kc=d(function(a){a.exports={default:jc,__esModule:!0}}),lc=d(function(a){var b=W("meta"),c=C.f,d=0,e=Object.isExtensible||function(){return!0},f=!t(function(){return e(Object.preventExtensions({}))}),g=function(a){c(a,b,{value:{i:"O"+ ++d,w:{}}})},h=function(a,c){if(!r(a))return"symbol"==typeof a?a:("string"==typeof a?"S":"P")+a;if(!J(a,b)){if(!e(a))return"F";if(!c)return"E";g(a)}return a[b].i},i=function(a,c){if(!J(a,b)){if(!e(a))return!0;if(!c)return!1;g(a)}return a[b].w},j=function(a){return f&&k.NEED&&e(a)&&!J(a,b)&&g(a),a},k=a.exports={KEY:b,NEED:!1,fastKey:h,getWeak:i,onFreeze:j}}),mc=C.f,nc=function(a){var b=o.Symbol||(o.Symbol={});"_"==a.charAt(0)||a in b||mc(b,a,{value:ic.f(a)})},oc=function(a,b){for(var c,d=m(a),e=ba(d),f=e.length,g=0;f>g;)if(d[c=e[g++]]===b)return c},pc=function(a){var b=ba(a),c=Zb.f;if(c)for(var d,e=c(a),f=_b.f,g=0;e.length>g;)f.call(a,d=e[g++])&&b.push(d);return b},qc=Array.isArray||function(a){return"Array"==j(a)},rc=aa.concat("length","prototype"),sc=Object.getOwnPropertyNames||function(a){return _(a,rc)},tc={f:sc},uc=tc.f,vc={}.toString,wc="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],xc=function(a){try{return uc(a)}catch(a){return wc.slice()}},yc=function(a){return wc&&"[object Window]"==vc.call(a)?xc(a):uc(m(a))},zc={f:yc},Ac=Object.getOwnPropertyDescriptor,Bc=u?Ac:function(a,b){if(a=m(a),b=z(b,!0),y)try{return Ac(a,b)}catch(a){}if(J(a,b))return D(!_b.f.call(a,b),a[b])},Cc={f:Bc},Dc=lc.KEY,Ec=Cc.f,Fc=C.f,Gc=zc.f,Hc=n.Symbol,Ic=n.JSON,Jc=Ic&&Ic.stringify,Kc=ja("_hidden"),Lc=ja("toPrimitive"),Mc={}.propertyIsEnumerable,Nc=T("symbol-registry"),Oc=T("symbols"),Pc=T("op-symbols"),Qc=Object.prototype,Rc="function"==typeof Hc,Sc=n.QObject,Tc=!Sc||!Sc.prototype||!Sc.prototype.findChild,Uc=u&&t(function(){return 7!=ia(Fc({},"a",{get:function(){return Fc(this,"a",{value:7}).a}})).a})?function(a,b,c){var d=Ec(Qc,b);d&&delete Qc[b],Fc(a,b,c),d&&a!==Qc&&Fc(Qc,b,d)}:Fc,Vc=function(a){var b=Oc[a]=ia(Hc.prototype);return b._k=a,b},Wc=Rc&&"symbol"==typeof Hc.iterator?function(a){return"symbol"==typeof a}:function(a){return a instanceof Hc},Xc=function(a,b,c){return a===Qc&&Xc(Pc,b,c),s(a),b=z(b,!0),s(c),J(Oc,b)?(c.enumerable?(J(a,Kc)&&a[Kc][b]&&(a[Kc][b]=!1),c=ia(c,{enumerable:D(0,!1)})):(J(a,Kc)||Fc(a,Kc,D(1,{})),a[Kc][b]=!0),Uc(a,b,c)):Fc(a,b,c)},Yc=function(a,b){s(a);for(var c,d=pc(b=m(b)),e=0,f=d.length;f>e;)Xc(a,c=d[e++],b[c]);return a},Zc=function(a,b){return void 0===b?ia(a):Yc(ia(a),b)},$c=function(a){var b=Mc.call(this,a=z(a,!0));return!(this===Qc&&J(Oc,a)&&!J(Pc,a))&&(!(b||!J(this,a)||!J(Oc,a)||J(this,Kc)&&this[Kc][a])||b)},_c=function(a,b){if(a=m(a),b=z(b,!0),a!==Qc||!J(Oc,b)||J(Pc,b)){var c=Ec(a,b);return!c||!J(Oc,b)||J(a,Kc)&&a[Kc][b]||(c.enumerable=!0),c}},ad=function(a){for(var b,c=Gc(m(a)),d=[],e=0;c.length>e;)J(Oc,b=c[e++])||b==Kc||b==Dc||d.push(b);return d},bd=function(a){for(var b,c=a===Qc,d=Gc(c?Pc:m(a)),e=[],f=0;d.length>f;)!J(Oc,b=d[f++])||c&&!J(Qc,b)||e.push(Oc[b]);return e};Rc||(Hc=function(){if(this instanceof Hc)throw TypeError("Symbol is not a constructor!");var a=W(arguments.length>0?arguments[0]:void 0),b=function(c){this===Qc&&b.call(Pc,c),J(this,Kc)&&J(this[Kc],a)&&(this[Kc][a]=!1),Uc(this,a,D(1,c))};return u&&Tc&&Uc(Qc,a,{configurable:!0,set:b}),Vc(a)},H(Hc.prototype,"toString",function(){return this._k}),Cc.f=_c,C.f=Xc,tc.f=zc.f=ad,_b.f=$c,Zb.f=bd,ic.f=function(a){return Vc(ja(a))}),G(G.G+G.W+G.F*!Rc,{Symbol:Hc});for(var cd="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),dd=0;cd.length>dd;)ja(cd[dd++]);for(var ed=ba(ja.store),fd=0;ed.length>fd;)nc(ed[fd++]);G(G.S+G.F*!Rc,"Symbol",{for:function(a){return J(Nc,a+="")?Nc[a]:Nc[a]=Hc(a)},keyFor:function(a){if(Wc(a))return oc(Nc,a);throw TypeError(a+" is not a symbol!")},useSetter:function(){Tc=!0},useSimple:function(){Tc=!1}}),G(G.S+G.F*!Rc,"Object",{create:Zc,defineProperty:Xc,defineProperties:Yc,getOwnPropertyDescriptor:_c,getOwnPropertyNames:ad,getOwnPropertySymbols:bd}),Ic&&G(G.S+G.F*(!Rc||t(function(){var a=Hc();return"[null]"!=Jc([a])||"{}"!=Jc({a:a})||"{}"!=Jc(Object(a))})),"JSON",{stringify:function(a){if(void 0!==a&&!Wc(a)){for(var b,c,d=[a],e=1;arguments.length>e;)d.push(arguments[e++]);return b=d[1],"function"==typeof b&&(c=b),!c&&qc(b)||(b=function(a,b){if(c&&(b=c.call(this,a,b)),!Wc(b))return b}),d[1]=b,Jc.apply(Ic,d)}}}),Hc.prototype[Lc]||E(Hc.prototype,Lc,Hc.prototype.valueOf),ma(Hc,"Symbol"),ma(Math,"Math",!0),ma(n.JSON,"JSON",!0),nc("asyncIterator"),nc("observable");var gd=o.Symbol,hd=d(function(a){a.exports={default:gd,__esModule:!0}}),id=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(kc),e=c(hd),f="function"==typeof e.default&&"symbol"==typeof d.default?function(a){return typeof a}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":typeof a};b.default="function"==typeof e.default&&"symbol"===f(d.default)?function(a){return void 0===a?"undefined":f(a)}:function(a){return a&&"function"==typeof e.default&&a.constructor===e.default&&a!==e.default.prototype?"symbol":void 0===a?"undefined":f(a)}}),jd=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(id);b.default=function(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==(void 0===b?"undefined":(0,c.default)(b))&&"function"!=typeof b?a:b}}),kd=c(jd),ld=function(a,b){if(s(a),!r(b)&&null!==b)throw TypeError(b+": can't set as prototype!")},md={set:Object.setPrototypeOf||("__proto__"in{}?function(a,b,c){try{c=q(Function.call,Cc.f(Object.prototype,"__proto__").set,2),c(a,[]),b=!(a instanceof Array)}catch(a){b=!0}return function(a,d){return ld(a,d),b?a.__proto__=d:c(a,d),a}}({},!1):void 0),check:ld};G(G.S,"Object",{setPrototypeOf:md.set});var nd=o.Object.setPrototypeOf,od=d(function(a){a.exports={default:nd,__esModule:!0}});G(G.S,"Object",{create:ia});var pd=o.Object,qd=function(a,b){return pd.create(a,b)},rd=d(function(a){a.exports={default:qd,__esModule:!0}}),sd=d(function(a,b){function c(a){return a&&a.__esModule?a:{default:a}}b.__esModule=!0;var d=c(od),e=c(rd),f=c(id);b.default=function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+(void 0===b?"undefined":(0,f.default)(b)));a.prototype=(0,e.default)(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(d.default?(0,d.default)(a,b):a.__proto__=b)}}),td=c(sd),ud=d(function(a){function b(){}function c(a,b,c){this.fn=a,this.context=b,this.once=c||!1}function d(){this._events=new b,this._eventsCount=0}var e=Object.prototype.hasOwnProperty,f="~";Object.create&&(b.prototype=Object.create(null),(new b).__proto__||(f=!1)),d.prototype.eventNames=function(){var a,b,c=[];if(0===this._eventsCount)return c;for(b in a=this._events)e.call(a,b)&&c.push(f?b.slice(1):b);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(a)):c},d.prototype.listeners=function(a,b){var c=f?f+a:a,d=this._events[c];if(b)return!!d;if(!d)return[];if(d.fn)return[d.fn];for(var e=0,g=d.length,h=new Array(g);e<g;e++)h[e]=d[e].fn;return h},d.prototype.emit=function(a,b,c,d,e,g){var h=f?f+a:a;if(!this._events[h])return!1;var i,j,k=this._events[h],l=arguments.length;if(k.fn){switch(k.once&&this.removeListener(a,k.fn,void 0,!0),l){case 1:return k.fn.call(k.context),!0;case 2:return k.fn.call(k.context,b),!0;case 3:return k.fn.call(k.context,b,c),!0;case 4:return k.fn.call(k.context,b,c,d),!0;case 5:return k.fn.call(k.context,b,c,d,e),!0;case 6:return k.fn.call(k.context,b,c,d,e,g),!0}for(j=1,i=new Array(l-1);j<l;j++)i[j-1]=arguments[j];k.fn.apply(k.context,i)}else{var m,n=k.length;for(j=0;j<n;j++)switch(k[j].once&&this.removeListener(a,k[j].fn,void 0,!0),l){case 1:k[j].fn.call(k[j].context);break;case 2:k[j].fn.call(k[j].context,b);break;case 3:k[j].fn.call(k[j].context,b,c);break;case 4:k[j].fn.call(k[j].context,b,c,d);break;default:if(!i)for(m=1,i=new Array(l-1);m<l;m++)i[m-1]=arguments[m];k[j].fn.apply(k[j].context,i)}}return!0},d.prototype.on=function(a,b,d){var e=new c(b,d||this),g=f?f+a:a;return this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],e]:this._events[g].push(e):(this._events[g]=e,this._eventsCount++),this},d.prototype.once=function(a,b,d){var e=new c(b,d||this,!0),g=f?f+a:a;return this._events[g]?this._events[g].fn?this._events[g]=[this._events[g],e]:this._events[g].push(e):(this._events[g]=e,this._eventsCount++),this},d.prototype.removeListener=function(a,c,d,e){var g=f?f+a:a;if(!this._events[g])return this;if(!c)return 0==--this._eventsCount?this._events=new b:delete this._events[g],this;var h=this._events[g];if(h.fn)h.fn!==c||e&&!h.once||d&&h.context!==d||(0==--this._eventsCount?this._events=new b:delete this._events[g]);else{for(var i=0,j=[],k=h.length;i<k;i++)(h[i].fn!==c||e&&!h[i].once||d&&h[i].context!==d)&&j.push(h[i]);j.length?this._events[g]=1===j.length?j[0]:j:0==--this._eventsCount?this._events=new b:delete this._events[g]}return this},d.prototype.removeAllListeners=function(a){var c;return a?(c=f?f+a:a,this._events[c]&&(0==--this._eventsCount?this._events=new b:delete this._events[c])):(this._events=new b,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.prefixed=f,d.EventEmitter=d,a.exports=d});G(G.S+G.F*!u,"Object",{defineProperty:C.f});var vd=o.Object,wd=function(a,b,c){return vd.defineProperty(a,b,c)},xd=d(function(a){a.exports={default:wd,__esModule:!0}}),yd=d(function(a,b){b.__esModule=!0;var c=function(a){return a&&a.__esModule?a:{default:a}}(xd);b.default=function(){function a(a,b){for(var d=0;d<b.length;d++){var e=b[d];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),(0,c.default)(a,e.key,e)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}()}),zd=c(yd),Ad=d(function(a,b){!function(){var c={VERSION:"2.4.0",Result:{SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},Error:{INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},WILDCARD:"*",ASYNC:"async",create:function(a,b){var d="string"==typeof a.initial?{state:a.initial}:a.initial,e=a.terminal||a.final,f=b||a.target||{},g=a.events||[],h=a.callbacks||{},i={},j={},k=function(a){var b=Array.isArray(a.from)?a.from:a.from?[a.from]:[c.WILDCARD];i[a.name]=i[a.name]||{};for(var d=0;d<b.length;d++)j[b[d]]=j[b[d]]||[],j[b[d]].push(a.name),i[a.name][b[d]]=a.to||b[d];a.to&&(j[a.to]=j[a.to]||[])};d&&(d.event=d.event||"startup",k({name:d.event,from:"none",to:d.state}));for(var l=0;l<g.length;l++)k(g[l]);for(var m in i)i.hasOwnProperty(m)&&(f[m]=c.buildEvent(m,i[m]));for(var m in h)h.hasOwnProperty(m)&&(f[m]=h[m]);return f.current="none",f.is=function(a){return Array.isArray(a)?a.indexOf(this.current)>=0:this.current===a},f.can=function(a){return!this.transition&&void 0!==i[a]&&(i[a].hasOwnProperty(this.current)||i[a].hasOwnProperty(c.WILDCARD))},f.cannot=function(a){return!this.can(a)},f.transitions=function(){return(j[this.current]||[]).concat(j[c.WILDCARD]||[])},f.isFinished=function(){return this.is(e)},f.error=a.error||function(a,b,c,d,e,f,g){throw g||f},f.states=function(){return Object.keys(j).sort()},d&&!d.defer&&f[d.event](),f},doCallback:function(a,b,d,e,f,g){if(b)try{return b.apply(a,[d,e,f].concat(g))}catch(b){return a.error(d,e,f,g,c.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",b)}},beforeAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onbeforeevent,b,d,e,f)},afterAnyEvent:function(a,b,d,e,f){return c.doCallback(a,a.onafterevent||a.onevent,b,d,e,f)},leaveAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onleavestate,b,d,e,f)},enterAnyState:function(a,b,d,e,f){return c.doCallback(a,a.onenterstate||a.onstate,b,d,e,f)},changeState:function(a,b,d,e,f){return c.doCallback(a,a.onchangestate,b,d,e,f)},beforeThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onbefore"+b],b,d,e,f)},afterThisEvent:function(a,b,d,e,f){return c.doCallback(a,a["onafter"+b]||a["on"+b],b,d,e,f)},leaveThisState:function(a,b,d,e,f){return c.doCallback(a,a["onleave"+d],b,d,e,f)},enterThisState:function(a,b,d,e,f){return c.doCallback(a,a["onenter"+e]||a["on"+e],b,d,e,f)},beforeEvent:function(a,b,d,e,f){if(!1===c.beforeThisEvent(a,b,d,e,f)||!1===c.beforeAnyEvent(a,b,d,e,f))return!1},afterEvent:function(a,b,d,e,f){c.afterThisEvent(a,b,d,e,f),c.afterAnyEvent(a,b,d,e,f)},leaveState:function(a,b,d,e,f){var g=c.leaveThisState(a,b,d,e,f),h=c.leaveAnyState(a,b,d,e,f);return!1!==g&&!1!==h&&(c.ASYNC===g||c.ASYNC===h?c.ASYNC:void 0)},enterState:function(a,b,d,e,f){c.enterThisState(a,b,d,e,f),c.enterAnyState(a,b,d,e,f)},buildEvent:function(a,b){return function(){var d=this.current,e=b[d]||(b[c.WILDCARD]!=c.WILDCARD?b[c.WILDCARD]:d)||d,f=Array.prototype.slice.call(arguments);if(this.transition)return this.error(a,d,e,f,c.Error.PENDING_TRANSITION,"event "+a+" inappropriate because previous transition did not complete");if(this.cannot(a))return this.error(a,d,e,f,c.Error.INVALID_TRANSITION,"event "+a+" inappropriate in current state "+this.current);if(!1===c.beforeEvent(this,a,d,e,f))return c.Result.CANCELLED;if(d===e)return c.afterEvent(this,a,d,e,f),c.Result.NOTRANSITION;var g=this;this.transition=function(){return g.transition=null,g.current=e,c.enterState(g,a,d,e,f),c.changeState(g,a,d,e,f),c.afterEvent(g,a,d,e,f),c.Result.SUCCEEDED},this.transition.cancel=function(){g.transition=null,c.afterEvent(g,a,d,e,f)};var h=c.leaveState(this,a,d,e,f);return!1===h?(this.transition=null,c.Result.CANCELLED):c.ASYNC===h?c.Result.PENDING:this.transition?this.transition():void 0}}};a.exports&&(b=a.exports=c),b.StateMachine=c}()}),Bd=function(){return Ad.create({initial:"calling",events:[{name:"connect",from:"calling",to:"connected"},{name:"close",from:"connected",to:"closed"},{name:"cancel",from:"calling",to:"canceled"},{name:"refuse",from:"calling",to:"refused"}]})},Cd=d(function(a,b){!function(b){function c(a){var b=k(a);if(q)for(var c,d=0;c=t[d++];)a.hasOwnProperty(c)&&b.push(c);return b}function d(a,b,d){for(var e,f,h=c(d),i=0,j=h.length;i<j;)"__self"!==(e=h[i++])&&(f=d[e],!o(f)||f.prototype&&f.prototype.__self||g&&!(f.toString().indexOf(".__base")>-1)?b[e]=f:b[e]=function(c,d){var e=a[c]?a[c]:"__constructor"===c?b.__self.__parent:p,f=function(){var a=this.__base;this.__base=f.__base;var b=d.apply(this,arguments);return this.__base=a,b};return f.__base=e,f}(e,f))}function e(a,b){for(var c,d=1;c=a[d++];)b?o(c)?f.self(b,c.prototype,c):f.self(b,c):b=o(c)?f(a[0],c.prototype,c):f(a[0],c);return b||a[0]}function f(){var a=arguments,b=n(a[0]),c=b||o(a[0]),f=c?b?e(a[0]):a[0]:h,g=a[c?1:0]||{},i=a[c?2:1],k=g.__constructor||c&&f.prototype&&f.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:c?function(){return f.apply(this,arguments)}:function(){};if(!c)return k.prototype=g,k.prototype.__self=k.prototype.constructor=k,l(k,i);l(k,f),k.__parent=f;var m=f.prototype,p=k.prototype=j(m);return p.__self=p.constructor=k,g&&d(m,p,g),i&&d(f,k,i),k}var g=function(){return"_"
}.toString().indexOf("_")>-1,h=function(){},i=Object.prototype.hasOwnProperty,j=Object.create||function(a){var b=function(){};return b.prototype=a,new b},k=Object.keys||function(a){var b=[];for(var c in a)i.call(a,c)&&b.push(c);return b},l=function(a,b){for(var c in b)i.call(b,c)&&(a[c]=b[c]);return a},m=Object.prototype.toString,n=Array.isArray||function(a){return"[object Array]"===m.call(a)},o=function(a){return"[object Function]"===m.call(a)},p=function(){},q=!0,r={toString:""};for(var s in r)r.hasOwnProperty(s)&&(q=!1);var t=q?["toString","valueOf"]:null;f.self=function(){var a=arguments,b=n(a[0]),c=b?e(a[0],a[0][0]):a[0],f=a[1],g=a[2],h=c.prototype;return f&&d(h,h,f),g&&d(c,c,g),c};var u=!0;a.exports=f,u=!1,"object"==typeof modules&&"function"==typeof modules.define&&(modules.define("inherit",function(a){a(f)}),u=!1),u&&(b.inherit=f)}(f)}),Dd=Cd;if(!b.TypedMessage)throw new Error("LeanCloud Realtime SDK not installed");var Ed=Dd(b.TypedMessage,{__constructor:function(a){this.__base(),this.payload=a,this.setTransient(!0)}});b.messageField("payload")(Ed);var Fd,Gd,Hd,Id,Jd,Kd,Ld,Md,Nd,Od,Pd=(Fd=b.messageType(-102))(Gd=function(a){function b(){return gc(this,b),kd(this,a.apply(this,arguments))}return td(b,a),b}(Ed))||Gd,Qd=(Hd=b.messageType(-103))(Id=function(a){function b(){return gc(this,b),kd(this,a.apply(this,arguments))}return td(b,a),b}(Ed))||Id,Rd=(Jd=b.messageType(-104))(Kd=function(a){function b(){return gc(this,b),kd(this,a.apply(this,arguments))}return td(b,a),b}(Ed))||Kd,Sd=(Ld=b.messageType(-105))(Md=function(a){function b(){return gc(this,b),kd(this,a.apply(this,arguments))}return td(b,a),b}(Ed))||Md,Td=function(a){function b(c,d){gc(this,b);var e=kd(this,a.call(this));e._setConversation(c),e._peerConnection=e._createPeerConnection(d),e._call=Bd(),e._promises={};var f=new Xb(function(a){e._promises.resolveStreamReady=a}),g=new Xb(function(a){e._promises.resolveAccept=a});return Xb.all([f,g]).then(function(a){var b=Va(a,1),c=b[0];e._call.can("connect")&&(e._call.connect(),e.emit("connect",c))}),e}return td(b,a),b.prototype.close=function(){var a=this;return Xb.resolve().then(function(){a._call.close(),a._destroyPeerConnection(),a._peerConnection.close(),a._destroy()})},b.prototype._handleCloseEvent=function(){this._call.can("close")&&(this.close(),this.emit("close"))},b.prototype._setConversation=function(a){this._conversation&&this._conversation.off("message"),a&&(this._conversation=a,a.on("message",this._handleMessage.bind(this)))},b.prototype._destroy=function(){this._conversation.off("message")},b.prototype._createPeerConnection=function(a){var b=new RTCPeerConnection(a);return b.onicecandidate=this._handleICECandidateEvent.bind(this),b.onaddstream=this._handleAddStreamEvent.bind(this),b.onnremovestream=this._handleRemoveStreamEvent.bind(this),b.oniceconnectionstatechange=this._handleICEConnectionStateChangeEvent.bind(this),b.onsignalingstatechange=this._handleSignalingStateChangeEvent.bind(this),b},b.prototype._destroyPeerConnection=function(){var a=this._peerConnection;delete a.onaddstream,delete a.onremovestream,delete a.onnicecandidate,delete a.oniceconnectionstatechange,delete a.onsignalingstatechange},b.prototype._handleMessage=function(a){return a instanceof Pd?this._handleAnswer(a):a instanceof Rd?this._handleRefusal():a instanceof Sd?this._handleCancelation():a instanceof Qd&&this._handleICECandidate(a)},b.prototype._handleICECandidate=function(a){var b=new RTCIceCandidate(a.payload);this._peerConnection&&this._peerConnection.addIceCandidate(b).catch(console.error.bind(console))},b.prototype._handleICECandidateEvent=function(a){return!(!a.candidate||!this._conversation)&&this._conversation.send(new Qd(a.candidate)).catch(console.error.bind(console))},b.prototype._handleAddStreamEvent=function(a){this._promises.resolveStreamReady(a.stream)},b.prototype._handleRemoveStreamEvent=function(){this._handleCloseEvent()},b.prototype._handleICEConnectionStateChangeEvent=function(){switch(this._peerConnection.iceConnectionState){case"closed":case"failed":case"disconnected":this._handleCloseEvent()}},b.prototype._handleSignalingStateChangeEvent=function(){switch(this._peerConnection.signalingState){case"closed":this._handleCloseEvent()}},b.prototype._handleAnswer=function(){throw new Error("not implemented")},b.prototype._handleRefusal=function(){throw new Error("not implemented")},b.prototype._handleCancelation=function(){throw new Error("not implemented")},zd(b,[{key:"state",get:function(){return this._call.current}}]),b}(ud),Ud=function(a){function b(c,d,e){gc(this,b);var f=kd(this,a.call(this,d,e));return f.to=c,f}return td(b,a),b.prototype._handleAnswer=function(a){var b=new RTCSessionDescription(a.payload);this._peerConnection.setRemoteDescription(b),this._promises.resolveAccept()},b.prototype._handleRefusal=function(){this._destroyPeerConnection(),this._call.refuse(),this.emit("refuse"),this._destroy()},b.prototype.cancel=function(){var a=this;return this._call.cancel(),this._conversation.send(new Sd).then(function(){return a._destroy()})},b.prototype.close=function(){return this._call.can("cancel")?this.cancel():a.prototype.close.call(this)},b}(Td),Vd=function(a){function b(c,d,e){gc(this,b);var f=kd(this,a.call(this,d,e));f.from=c.from;var g=new RTCSessionDescription(c.payload);return f._handleOfferPromise=f._peerConnection.setRemoteDescription(g),f}return td(b,a),b.prototype.accept=function(a){var b=this;if(!a)throw new TypeError("a MediaStream instance is required to accept a call");return this._handleOfferPromise.then(function(){return b._peerConnection.addStream(a)}).then(function(){return b._peerConnection.createAnswer()}).then(function(a){return b._peerConnection.setLocalDescription(a)}).then(function(){return b._conversation.send(new Pd(b._peerConnection.localDescription))}).then(function(){return b._promises.resolveAccept()})},b.prototype.refuse=function(){var a=this;return this._conversation.send(new Rd).then(function(){a._call.refuse(),a._destroy()})},b.prototype._handleCancelation=function(){this._call.cancel(),this.emit("cancel"),this._destroy()},b}(Td),Wd=(Nd=b.messageType(-101))(Od=function(a){function b(){return gc(this,b),kd(this,a.apply(this,arguments))}return td(b,a),b}(Ed))||Od,Xd={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302","stun:stun.ekiga.net","stun:stun.ideasip.com","stun:stun.rixtelecom.se","stun:stun.schlund.de","stun:stun.stunprotocol.org:3478","stun:stun.voiparound.com","stun:stun.voipbuster.com","stun:stun.voipstunt.com","stun:stun.voxgratia.org"]}]},Yd=function(a){function b(c,d){if(gc(this,b),"string"!=typeof c)throw new TypeError("id is not a string");var e=kd(this,a.call(this));return e.id=c,e.options=ec({RTCConfiguration:Xd},d),e}return td(b,a),b.prototype._open=function(a,b){var c=this;return a.createIMClient(this.id,b,"webrtc").then(function(a){return c._imClient=a,c.id=a.id,a.on("message",function(a,b){return a instanceof Wd&&c._handleOffer(a,b)}),a.on("conflict",function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return c.emit.apply(c,["conflict"].concat(b))}),c})},b.prototype.close=function(){return this._imClient.close()},b.prototype.call=function(a,b){var c=this;if("string"!=typeof a)throw new TypeError("target id is not a string");if(!b)throw new TypeError("a MediaStream instance is required to make a call");return this._imClient.ping([a]).then(function(d){if(!d.length)throw new Error("Call failed as "+a+" is not online");var e=new Ud(a,null,c.options.RTCConfiguration),f=new Xb(function(a){e._peerConnection.onnegotiationneeded=a});return e._peerConnection.addStream(b),f.then(function(){return Xb.all([c._imClient.createConversation({members:[a],unique:!0}),e._peerConnection.createOffer().then(function(a){e._peerConnection.setLocalDescription(a)})])}).then(function(a){var b=Va(a,1),c=b[0];return e._setConversation(c),c.send(new Wd(e._peerConnection.localDescription))}).then(function(){return e})})},b.prototype._handleOffer=function(a,b){var c=new Vd(a,b,this.options.RTCConfiguration);this.emit("call",c)},b}(ud),Zd=[Wd,Pd,Qd,Rd,Sd],$d=function(a){a.createWebRTCClient=function(b,c){return new Yd(b)._open(a,c)}},_d={name:"leancloud-realtime-plugin-webrtc",messageClasses:Zd,onRealtimeCreate:$d},ae=!!(window.RTCPeerConnection&&window.RTCSessionDescription&&window.RTCIceCandidate);a.WebRTCPlugin=_d,a.isWebRTCSupported=ae,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=webrtc.min.js.map